<?php

use yii\helpers\Url;

/* @var $this yii\web\View */
/* @var $model common\models\AnalisaAlternatif */

\yii\web\YiiAsset::register($this);

$this->title = ' Hasil Analisa Alternatif';

$jk = Yii::$app->request->get('jk');

$uHome = Url::base(true);
$uIndex = Url::toRoute(['index', 'jk' => Yii::$app->request->get('jk')]);
$uBack = Yii::$app->request->referrer ?: $uHome;

$this->params['header-block'] = <<< HTML
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <div class="row align-items-center">
                    <div class="col-sm-9">
                        <h4 class="page-title">{$this->title}</h4>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{$uHome}"><i class="mdi mdi-home-outline"></i></a></li>
                            <li class="breadcrumb-item"><a href="{$uIndex}">Analisa Alternatif</a></li>
                            <li class="breadcrumb-item active">{$this->title}</li>
                        </ol>
                    </div>

                    <div class="col-sm-3">
                        <div class="float-right d-none d-md-block">
                            <a href="{$uBack}" class="btn btn-secondary">
                                <i class="mdi mdi-arrow-left mr-2"></i>
                                Kembali
                            </a>
                        </div>
                    </div> <!-- end col-->
                </div> <!-- end row-->
            </div>
            <!-- end page title -->
        </div> <!-- end col -->
    </div> <!-- end row-->
</div>
HTML;
?>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
              <div class="row">
        				<div class="col-md-6 text-left">
        					<strong style="font-size:18pt;"><span class="fa fa-table"></span> Alternatif Menurut Kriteria</strong>
        				</div>
        				<div class="col-md-6 text-right">
        					<form method="post">
        	          <button name="hapus" class="btn btn-danger">Hapus Semua Data</button>
        					</form>
        				</div>
        			</div>
                <br/>

                <table width="100%" class="table table-striped table-bordered">
                  <thead>
                    <tr>
                      <th class="text-center active">Alternatif</th>
                      <?php foreach ($dataKriteria as $judul) { ?>
                        <th><?=$judul['nama_kriteria']?></th>
                      <?php } ?>
                      <th>Hasil Si</th>
                      <th>Hasil Ri</th>
                      <th>Hasil Qi</th>
                      <th>Hasil Qii</th>
                      <th>Hasil Qiii</th>
                    </tr>

                  </thead>
                  <tbody>
                    <?php foreach ($dataMahasiswa as $baris) { ?>
                      <tr>
                        <th class="active"><?=$baris['nama']?></th>
                        <?php foreach ($dataKriteria as $kolom) { ?>
                        <td>
                          <?php
                            $bobot = $getSkor($baris['id'], $kolom['id_kriteria']);
                            $hasil = $bobot['bobot'] * $kolom['bobot_kriteria'];
                            echo number_format($hasil, 4, '.', ',');
                            $normalisasi = $inputNormalisasi($hasil, $baris['id'], $kolom['id_kriteria'])
                          ?>
                        </td>
                        <?php } ?>
                        <td>
                          <?php
                            $si = $jumlah($baris['id']);
                            echo number_format($si['jumlah'], 4, '.', ',');
                            $satu = $inputSi($si['jumlah'], $baris['id']);
                          ?>
                        </td>
                        <td>
                          <?php
                            $ri = $terbesar($baris['id']);
                            echo number_format($ri['max'], 4, '.', ',');
                            $dua = $inputRi($ri['max'], $baris['id']);
                          ?>
                        </td>

                        <td>
                          <?php
                            $maxSi = $utility($baris['id']);
                            $maxRi = $regret($baris['id']);
                            $minSi = $utility($baris['id']);
                            $minRi = $regret($baris['id']);

                            $qi = (0.5*(($si['jumlah']-$minSi['smallest'])/($maxSi['largest']-$minSi['smallest'])))+((1-0.5)*(($ri['max']-$minRi['smallest'])/($maxRi['largest']-$minRi['smallest'])));
                            $qii = (0.45*(($si['jumlah']-$minSi['smallest'])/($maxSi['largest']-$minSi['smallest'])))+((1-0.45)*(($ri['max']-$minRi['smallest'])/($maxRi['largest']-$minRi['smallest'])));
                            $qiii = (0.55*(($si['jumlah']-$minSi['smallest'])/($maxSi['largest']-$minSi['smallest'])))+((1-0.55)*(($ri['max']-$minRi['smallest'])/($maxRi['largest']-$minRi['smallest'])));
                            echo number_format($qi, 4, '.', ',');

                            $tiga = $inputQi($qi, $qii, $qiii, $baris['id']);
                          ?>
                        </td>
                        <td><?= number_format($qii, 4, '.', ','); ?></td>
                        <td><?= number_format($qiii, 4, '.', ','); ?></td>
                      </tr>
                    <?php } ?>
                  </tbody>

                  <tfoot>
                    <tr class="info">
                      <th>Maksimal</th>
                        <?php foreach ($dataKriteria as $judul) { ?>
                          <td></td>
                        <?php } ?>
                        <td><?= number_format($maxSi['largest'], 4, '.', ','); ?></td>
                        <td><?= number_format($maxRi['largest'], 4, '.', ','); ?></td>
                    </tr>
                    <tr class="info">
                      <th>Minimal</th>
                        <?php foreach ($dataKriteria as $judul) { ?>
                          <td></td>
                        <?php } ?>
                        <td><?= number_format($minSi['smallest'], 4, '.', ','); ?></td>
                        <td><?= number_format($minRi['smallest'], 4, '.', ','); ?></td>
                    </tr>
                  </tfoot>
                </table>

          </div>
      </div>
  </div>
</div>
